<!DOCTYPE html>
<html lang="zh-tw"><head>
  <meta charset="utf-8">
  <title>Yuan-Kang Lee</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Instrument Recognition by Time-Frequency Analysis and K-means algorithm">
  <meta name="author" content="Neil Lee">
  <meta name="generator" content="Hugo 0.139.3">

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://NTUneillee.github.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://NTUneillee.github.io/plugins/slick/slick.css ">
  
  <link rel="stylesheet" href="https://NTUneillee.github.io/plugins/themify-icons/themify-icons.css ">
  
  <link rel="stylesheet" href="https://NTUneillee.github.io/plugins/venobox/venobox.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://NTUneillee.github.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://NTUneillee.github.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://NTUneillee.github.io/images/favicon.png " type="image/x-icon">

  <!-- google analitycs -->
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
        m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'Your ID', 'auto');
    ga('send', 'pageview');
  </script>

</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0">
      
      <a class="navbar-brand mobile-view" href="https://NTUneillee.github.io/">
        <img class="img-fluid" src="https://NTUneillee.github.io/images/logologo1.png" alt="Yuan-Kang Lee">
      </a>
      
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        
        <a class="navbar-brand desktop-view" href="https://NTUneillee.github.io/">
          <img class="img-fluid" src="https://NTUneillee.github.io/images/logologo1.png" alt="Yuan-Kang Lee">
        </a>

        
        <div class="desktop-view">
          <ul class="navbar-nav mr-auto">
            
            <li class="nav-item">
              <a class="nav-link" href="https://www.linkedin.com/in/yuankanglee"><i class="ti-linkedin"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/NTUneillee"><i class="ti-github"></i></a>
            </li>
            
            <li class="nav-item">
              <a class="nav-link" href="https://scholar.google.com/citations?user=CSHORSwAAAAJ&amp;hl=en"><i class="ti-book"></i></a>
            </li>
            
          </ul>
        </div>

        
        <ul class="navbar-nav mx-auto">
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://NTUneillee.github.io/about/">About</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://NTUneillee.github.io/news/">News</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://NTUneillee.github.io/blog/">Project</a>
          </li>
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="https://NTUneillee.github.io/research/">Research</a>
          </li>
          
          
        </ul>

        
        
        <!-- search -->
        <div class="search pl-lg-4">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://NTUneillee.github.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        

        
        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation -->

<section class="section-sm">
  <div class="container">
    <div class="row">
      <div class="col-lg-10 mx-auto">
        
        <a href="/categories/signal-processing"
          class="text-primary">Signal processing</a>
        
        <h2>Music Instrument Recognition Project</h2>
        <div class="mb-3 post-meta">
          <span>By Neil Lee</span>
          
          <span class="border-bottom border-primary px-2 mx-1"></span>
          <span>03 July 2022</span>
          
        </div>
        
        <img src="https://NTUneillee.github.io/images/post/instrument.jpg" class="img-fluid w-100 mb-4" alt="Music Instrument Recognition Project">
        
        <div class="content mb-5">
          <h2 id="introduction">Introduction</h2>
<p>The project is an Instrument Recognition Program with Matlab, featuring Time-Frequency Analysis method, Gabor Transform algorithm, Signal Feature Extraction, LBG Vector Quantization and K-means algorithm to achieve up to 80% recognition in musical instruments including Piano, Guitar, and Cello.</p>
<h2 id="library">Library</h2>
<p>library_cello1.mat, library_cello2.mat, library_cello3.mat, library_guitar1.mat, library_guitar2.mat, library_guitar3.mat, library_piano1.mat, library_piano2.mat, library_piano3.mat are the Libraries that I collected from thousnad of instrument music signals.</p>
<h2 id="program-code">Program Code</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Matlab" data-lang="Matlab"><span style="display:flex;"><span>clear; close all; clc;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[a, fs] = audioread(<span style="color:#e6db74">&#39;music.wav&#39;</span>);
</span></span><span style="display:flex;"><span>segmentation = <span style="color:#ae81ff">5</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Main Algorithm of Gabor Transform</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x = a(:,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>tau = <span style="color:#ae81ff">0</span> : <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">44100</span> : <span style="color:#ae81ff">3.2</span>;
</span></span><span style="display:flex;"><span>dt = <span style="color:#ae81ff">0.01</span>;
</span></span><span style="display:flex;"><span>df = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>t = <span style="color:#ae81ff">0</span> : dt : max(tau);
</span></span><span style="display:flex;"><span>f = <span style="color:#ae81ff">20</span> : df : <span style="color:#ae81ff">2500</span>;
</span></span><span style="display:flex;"><span>sigma = <span style="color:#ae81ff">200</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dt = t(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>t(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>df = f(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>f(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>dtau = tau(<span style="color:#ae81ff">2</span>)<span style="color:#f92672">-</span>tau(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>S = dt<span style="color:#f92672">/</span>dtau;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C = length(t);
</span></span><span style="display:flex;"><span>F = length(f);
</span></span><span style="display:flex;"><span>T = length(tau);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>N = <span style="color:#ae81ff">1</span> <span style="color:#f92672">/</span> (df<span style="color:#f92672">*</span>dtau);
</span></span><span style="display:flex;"><span>B = <span style="color:#ae81ff">1.9143</span> <span style="color:#f92672">/</span> (sigma^(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>Q = round( B<span style="color:#f92672">/</span>dtau );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n0 = tau(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> dtau;
</span></span><span style="display:flex;"><span>c0 = t(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> dt;
</span></span><span style="display:flex;"><span>m0 = f(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">/</span> df;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X = zeros(C,F);
</span></span><span style="display:flex;"><span>x1 = zeros(<span style="color:#ae81ff">1</span>,N);
</span></span><span style="display:flex;"><span>window = (sigma^(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>)) <span style="color:#f92672">*</span> exp( <span style="color:#f92672">-</span>sigma<span style="color:#f92672">*</span>pi<span style="color:#f92672">*</span>( (Q<span style="color:#f92672">-</span>( <span style="color:#ae81ff">0</span>:N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> ))<span style="color:#f92672">*</span>dtau )<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span> );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> n = c0 :( c0<span style="color:#f92672">+</span>C<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>    window_const = dtau <span style="color:#f92672">*</span> exp( (<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>j<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>pi<span style="color:#f92672">*</span>( n<span style="color:#f92672">*</span>S<span style="color:#f92672">-</span>Q ) ) <span style="color:#f92672">.*</span> ( m0:(m0<span style="color:#f92672">+</span>F<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) )<span style="color:#f92672">./</span>N);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> q = <span style="color:#ae81ff">0</span> : N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( (q<span style="color:#f92672">&lt;</span>=(<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>Q) ) <span style="color:#f92672">&amp;&amp;</span> ( n<span style="color:#f92672">*</span>S<span style="color:#f92672">-</span>Q<span style="color:#f92672">+</span>q<span style="color:#f92672">&gt;</span>=<span style="color:#ae81ff">0</span> ) <span style="color:#f92672">&amp;&amp;</span> ( n<span style="color:#f92672">*</span>S<span style="color:#f92672">-</span>Q<span style="color:#f92672">+</span>q<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">&lt;</span>=T ) )
</span></span><span style="display:flex;"><span>            x1(q<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) = x( n<span style="color:#f92672">*</span>S<span style="color:#f92672">-</span>Q<span style="color:#f92672">+</span>q<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> ); 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>            x1(q<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>) = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>    
</span></span><span style="display:flex;"><span>    X1 = fft( (window<span style="color:#f92672">.*</span>x1), N);   
</span></span><span style="display:flex;"><span>    X( (n<span style="color:#f92672">-</span>c0)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, :) = window_const <span style="color:#f92672">.*</span> X1( m0<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> : ( (m0<span style="color:#f92672">+</span>F<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> ) );
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>y = X<span style="color:#f92672">&#39;</span>; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Convolution to g[n,m] and find Instantaneous Frequency</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>f0 = <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>L = (<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>(f0<span style="color:#f92672">/</span>dt));
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> n_ = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">5</span> <span style="color:#75715e">% n_ = n+3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> m_ = <span style="color:#ae81ff">1</span>: (<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>L<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)  <span style="color:#75715e">% m_ = L+(L+1) </span>
</span></span><span style="display:flex;"><span>        g(n_,m_) = exp(<span style="color:#f92672">-</span>(((m_<span style="color:#f92672">-</span>(L<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">*</span>df)^<span style="color:#ae81ff">2</span>))<span style="color:#f92672">/</span>f0^<span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>Xs = conv2(abs(y),g<span style="color:#f92672">&#39;</span>,<span style="color:#e6db74">&#39;same&#39;</span>); 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Create Threshold matrix of instantaneous frequency</span>
</span></span><span style="display:flex;"><span>threshold_value = max(max(abs(Xs))) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.01</span>;
</span></span><span style="display:flex;"><span>threshold = zeros(F,C);
</span></span><span style="display:flex;"><span>threshold = threshold <span style="color:#f92672">+</span> threshold_value;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Create Instantaneous Frequency zero matrix for later storing data  </span>
</span></span><span style="display:flex;"><span>InstantaneousFreq = zeros( size(Xs) );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> m = <span style="color:#ae81ff">1</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> : F<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#75715e">% to avoid reaching invalid index </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n = <span style="color:#ae81ff">1</span> : C  
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">% find max frequency to become instantaneous frequency</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( Xs(m,n)<span style="color:#f92672">&gt;</span>Xs(m<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,n) ) <span style="color:#f92672">&amp;&amp;</span> ( Xs(m,n)<span style="color:#f92672">&gt;</span>Xs(m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,n) ) <span style="color:#f92672">&amp;&amp;</span> ( abs((Xs(m,n))) <span style="color:#f92672">&gt;</span> threshold(m,n) )
</span></span><span style="display:flex;"><span>            InstantaneousFreq(m,n) = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> 
</span></span><span style="display:flex;"><span>            InstantaneousFreq(m,n) = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Connect [m,n] to create clear Instantaneous Frequency line</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% create Clear Frequency data matrix for later operation</span>
</span></span><span style="display:flex;"><span>ClearFrequency = []; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : F
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% extract every frequency line row by row </span>
</span></span><span style="display:flex;"><span>    tmp = InstantaneousFreq(i,:); 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% identify the index of clear frequency line</span>
</span></span><span style="display:flex;"><span>    index = find( abs( real(tmp) ) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.0001</span> );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j = <span style="color:#ae81ff">1</span> : C
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ismember(j, index)
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">% let the clear frequency line element to 1</span>
</span></span><span style="display:flex;"><span>            tmp(j) = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">% remove the unclear frequemcy line</span>
</span></span><span style="display:flex;"><span>            tmp(j) = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% label the different region of clear frequemcy line</span>
</span></span><span style="display:flex;"><span>    tmp = bwlabel(tmp, <span style="color:#ae81ff">8</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% find how many number of clear frequency line region</span>
</span></span><span style="display:flex;"><span>    tmp_max = max(tmp, [], <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k = <span style="color:#ae81ff">1</span> : tmp_max
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> size( find( tmp<span style="color:#f92672">==</span>k ) ) <span style="color:#f92672">&lt;</span> segmentation <span style="color:#75715e">% Segmentation Variable </span>
</span></span><span style="display:flex;"><span>            tmp( find( tmp<span style="color:#f92672">==</span>k ) ) = <span style="color:#ae81ff">0</span>; 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>            tmp( find( tmp<span style="color:#f92672">==</span>k ) ) = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% store data in Clear Frequecny matrix</span>
</span></span><span style="display:flex;"><span>    ClearFrequency = [ ClearFrequency ; tmp ]; 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% show the plot of siganl after Gabor Transform </span>
</span></span><span style="display:flex;"><span>figure; 
</span></span><span style="display:flex;"><span>image(t,f,abs(y)<span style="color:#f92672">/</span>max(max(abs(y)))<span style="color:#f92672">*</span><span style="color:#ae81ff">400</span>)			
</span></span><span style="display:flex;"><span>colormap(gray(<span style="color:#ae81ff">256</span>))								
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Ydir&#39;</span>,<span style="color:#e6db74">&#39;normal&#39;</span>)						
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)							
</span></span><span style="display:flex;"><span>xlabel(<span style="color:#e6db74">&#39;Time (Sec)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)				
</span></span><span style="display:flex;"><span>ylabel(<span style="color:#e6db74">&#39;Frequency (Hz)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% show the plot of Instantaneous Frequency </span>
</span></span><span style="display:flex;"><span>figure; 
</span></span><span style="display:flex;"><span>image(t,f,abs(InstantaneousFreq)<span style="color:#f92672">/</span>max(max(abs(InstantaneousFreq)))<span style="color:#f92672">*</span><span style="color:#ae81ff">400</span>)			
</span></span><span style="display:flex;"><span>colormap(gray(<span style="color:#ae81ff">256</span>))								
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Ydir&#39;</span>,<span style="color:#e6db74">&#39;normal&#39;</span>)						
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)							
</span></span><span style="display:flex;"><span>xlabel(<span style="color:#e6db74">&#39;Time (Sec)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)				
</span></span><span style="display:flex;"><span>ylabel(<span style="color:#e6db74">&#39;Frequency (Hz)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% show the plot of Clear Instantaneous Frequency </span>
</span></span><span style="display:flex;"><span>figure; 
</span></span><span style="display:flex;"><span>image(t,f,abs(ClearFrequency)<span style="color:#f92672">/</span>max(max(abs(ClearFrequency)))<span style="color:#f92672">*</span><span style="color:#ae81ff">400</span>)			
</span></span><span style="display:flex;"><span>colormap(gray(<span style="color:#ae81ff">256</span>))								
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Ydir&#39;</span>,<span style="color:#e6db74">&#39;normal&#39;</span>)						
</span></span><span style="display:flex;"><span>set(gca,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)							
</span></span><span style="display:flex;"><span>xlabel(<span style="color:#e6db74">&#39;Time (Sec)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)				
</span></span><span style="display:flex;"><span>ylabel(<span style="color:#e6db74">&#39;Frequency (Hz)&#39;</span>,<span style="color:#e6db74">&#39;Fontsize&#39;</span>,<span style="color:#ae81ff">12</span>)	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Find the MAX time sample number of all instantaneous frequency</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% create FreqTimeSample data matrix for later operation</span>
</span></span><span style="display:flex;"><span>FreqTimeSample = []; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% label the different region of clear frequemcy line</span>
</span></span><span style="display:flex;"><span>ClearFrequency_label = bwlabel( ClearFrequency, <span style="color:#ae81ff">8</span> );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% find how many number of clear frequency line region</span>
</span></span><span style="display:flex;"><span>label_max = max(ClearFrequency_label, [], <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : label_max
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% find the number of time sample of every instantaneous frequency</span>
</span></span><span style="display:flex;"><span>    FreqTimeSample_tmp = size( find(ClearFrequency_label <span style="color:#f92672">==</span> i) , <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% store data in FreqTimeSample matrix</span>
</span></span><span style="display:flex;"><span>    FreqTimeSample = [ FreqTimeSample FreqTimeSample_tmp ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% find the MAX time sample number of instantaneous frequency </span>
</span></span><span style="display:flex;"><span>MAX_FreqTimeSample = max(FreqTimeSample);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Find Real Frequency Value and its Time data of all frequency</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% create Real Frequency Value data matrix for later operation</span>
</span></span><span style="display:flex;"><span>RealFreqValue = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% TimeRange will lose 1 data after sampling (round down) </span>
</span></span><span style="display:flex;"><span>MaxSampleNum = MAX_FreqTimeSample <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% initial setting of Time Data for all time sample of frequency  </span>
</span></span><span style="display:flex;"><span>TimeData = zeros(label_max, MaxSampleNum);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% initial setting of Frequency Value Data for all time sample of frequency </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% indexes of FreqValueData are correspond to its TimeData</span>
</span></span><span style="display:flex;"><span>FreqValueData = zeros(label_max , MaxSampleNum);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[ row, column ] = size(ClearFrequency);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : label_max 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    [r, c] = find( ClearFrequency_label <span style="color:#f92672">==</span> i );
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% calculate the Real Frequency Value of Instaneous frequency</span>
</span></span><span style="display:flex;"><span>    FreqValue = mean(r) <span style="color:#f92672">+</span> <span style="color:#ae81ff">20</span>; <span style="color:#75715e">% correction coefficient ylim [20 1001] </span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% store data in Real Frequency Value matrix</span>
</span></span><span style="display:flex;"><span>    RealFreqValue = [ RealFreqValue FreqValue ];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% calculate the Real Time Value of every sample and find its min and max</span>
</span></span><span style="display:flex;"><span>    c_min = min(c) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1.6</span><span style="color:#f92672">/</span>column);
</span></span><span style="display:flex;"><span>    c_max = max(c) <span style="color:#f92672">*</span> (<span style="color:#ae81ff">1.6</span><span style="color:#f92672">/</span>column);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% TimeRange store the data of all time sample for all Freq region</span>
</span></span><span style="display:flex;"><span>    TimeRange = [ c_min : dt : c_max ];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k = <span style="color:#ae81ff">1</span> : size( TimeRange,<span style="color:#ae81ff">2</span> ) <span style="color:#75715e">% how many time sample in this region</span>
</span></span><span style="display:flex;"><span>        TimeData(i,k) = TimeRange(k);
</span></span><span style="display:flex;"><span>        FreqValueData(i,k) = FreqValue;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Find frequency energy ratio of all primary frequency region </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>E1_set = [];
</span></span><span style="display:flex;"><span>E2_set = [];
</span></span><span style="display:flex;"><span>E3_set = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>EnergyRatioE2E1_set = [];
</span></span><span style="display:flex;"><span>EnergyRatioE3E1_set = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>E_onset_set = [];
</span></span><span style="display:flex;"><span>E_offset_set = [];
</span></span><span style="display:flex;"><span>E_all_set =[];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>EnergyRatioOn_set = [];
</span></span><span style="display:flex;"><span>EnergyRatioOff_set = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> FrequencyRegion = <span style="color:#ae81ff">1</span> : label_max
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    y_value = (abs(y))<span style="color:#f92672">.^</span><span style="color:#ae81ff">2</span>; 
</span></span><span style="display:flex;"><span>    [r, c] = find( ClearFrequency_label <span style="color:#f92672">==</span> FrequencyRegion );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    fmin1 = <span style="color:#ae81ff">0.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    fmax1 = <span style="color:#ae81ff">1.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    min_row1 = round(fmin1) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    max_row1 = round(fmax1) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> min_row1 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        min_row1 = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> max_row1 <span style="color:#f92672">&gt;</span> F
</span></span><span style="display:flex;"><span>        max_row1 = F;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    E1 = sum( y_value( min_row1 : max_row1 , min(c) : max(c) ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>    E1_set = [ E1_set E1 ]; 
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    fmin2 = <span style="color:#ae81ff">1.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    fmax2 = <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    min_row2 = round(fmin2) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    max_row2 = round(fmax2) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> min_row2 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        min_row2 = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> max_row2 <span style="color:#f92672">&gt;</span> F
</span></span><span style="display:flex;"><span>        max_row2 = F;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    E2 = sum( y_value( min_row2 : max_row2 , min(c) : max(c) ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>    E2_set = [ E2_set E2 ];
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    fmin3 = <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    fmax3 = <span style="color:#ae81ff">3.5</span> <span style="color:#f92672">*</span> RealFreqValue(FrequencyRegion);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    min_row3 = round(fmin3) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    max_row3 = round(fmax3) <span style="color:#f92672">-</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> min_row3 <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        min_row3 = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> max_row3 <span style="color:#f92672">&gt;</span> F
</span></span><span style="display:flex;"><span>        max_row3 = F;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>​    E3 = sum( y_value( min_row3 : max_row3 , min(c) : max(c) ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>​    E3_set = [ E3_set E3 ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    EnergyRatioE2E1 = E2 <span style="color:#f92672">/</span> E1;
</span></span><span style="display:flex;"><span>​    EnergyRatioE2E1_set = [ EnergyRatioE2E1_set EnergyRatioE2E1 ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    EnergyRatioE3E1 = E3 <span style="color:#f92672">/</span> E1;
</span></span><span style="display:flex;"><span>​    EnergyRatioE3E1_set = [ EnergyRatioE3E1_set EnergyRatioE3E1 ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    begin_all = min(c); 
</span></span><span style="display:flex;"><span>​    finish_all = max(c);
</span></span><span style="display:flex;"><span>​    begin_onset = min(c);
</span></span><span style="display:flex;"><span>​    finish_onset = min(c) <span style="color:#f92672">+</span> round(( (max(c)<span style="color:#f92672">-</span>min(c)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.1</span> ));
</span></span><span style="display:flex;"><span>​    begin_offset = min(c) <span style="color:#f92672">+</span> round(( (max(c)<span style="color:#f92672">-</span>min(c)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.9</span> ));
</span></span><span style="display:flex;"><span>​    finish_offset = max(c);
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​    LowLimit = round( ( RealFreqValue(FrequencyRegion) <span style="color:#f92672">-</span><span style="color:#ae81ff">20</span> ) <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span> );  
</span></span><span style="display:flex;"><span>​    HighLimit = round( ( RealFreqValue(FrequencyRegion) <span style="color:#f92672">-</span><span style="color:#ae81ff">20</span> ) <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> );
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">if</span> ( LowLimit <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>​        LowLimit = <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">elseif</span> (HighLimit <span style="color:#f92672">&gt;</span> F )
</span></span><span style="display:flex;"><span>​        HighLimit = F;
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    E_onset = sum( y_value( LowLimit:HighLimit, begin_onset:finish_onset ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>​    E_onset_set = [ E_onset_set E_onset ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    E_offset = sum( y_value( LowLimit:HighLimit, begin_offset:finish_offset ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>​    E_offset_set = [ E_offset_set E_offset ];
</span></span><span style="display:flex;"><span>​      
</span></span><span style="display:flex;"><span>​    E_all = sum( y_value( LowLimit:HighLimit, begin_all:finish_all ) , <span style="color:#e6db74">&#39;all&#39;</span>);
</span></span><span style="display:flex;"><span>​    E_all_set =[ E_all_set E_all ];
</span></span><span style="display:flex;"><span>​     
</span></span><span style="display:flex;"><span>​    EnergyRatioOn = E_onset <span style="color:#f92672">/</span> E_all;
</span></span><span style="display:flex;"><span>​    EnergyRatioOn_set = [ EnergyRatioOn_set EnergyRatioOn ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    EnergyRatioOff = E_offset <span style="color:#f92672">/</span> E_all;
</span></span><span style="display:flex;"><span>​    EnergyRatioOff_set = [ EnergyRatioOff_set EnergyRatioOff ];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Find error between Real Frequency &amp; its second-order approximation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% ===================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% create error data matrix of each frequency region for later operation</span>
</span></span><span style="display:flex;"><span>error_set = []; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> FrequencyRegion = <span style="color:#ae81ff">1</span> : label_max
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">% create Frequency column vector data of every sample point</span>
</span></span><span style="display:flex;"><span>    B = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : MaxSampleNum
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% extract the TimeData of every sample point row by row </span>
</span></span><span style="display:flex;"><span>​        n_FreqTimeSample = TimeData( FrequencyRegion, : );
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% find B = [ m m*n m*n^2 ]&#39; column vector for approximation</span>
</span></span><span style="display:flex;"><span>​        B_tmp = RealFreqValue( FrequencyRegion ) <span style="color:#f92672">*</span> n_FreqTimeSample(i) <span style="color:#f92672">.^</span> (<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% the element of B_tmp that not exist is time = 0</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">if</span> ( B_tmp(<span style="color:#ae81ff">2</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> ) <span style="color:#f92672">&amp;&amp;</span> ( B_tmp(<span style="color:#ae81ff">3</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) 
</span></span><span style="display:flex;"><span>​            B_tmp(<span style="color:#ae81ff">1</span>) = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% change the element of not exist B_tmp become zero column vector </span>
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        B = [ B B_tmp<span style="color:#f92672">&#39;</span>];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">end</span> 
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​    <span style="color:#75715e">% create approximation coefficient for every sample point</span>
</span></span><span style="display:flex;"><span>​    S = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : MaxSampleNum 
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% extract the Frequemcy data of every region column by column</span>
</span></span><span style="display:flex;"><span>​        B_column = B(:,i);
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% create A matrix for second-order approximation</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">for</span> n = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span> 
</span></span><span style="display:flex;"><span>​            <span style="color:#66d9ef">for</span> m = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>​                <span style="color:#66d9ef">for</span> k = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>​                    A(m,k) = ( n_FreqTimeSample(i) )^( m<span style="color:#f92672">+</span>k<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> );
</span></span><span style="display:flex;"><span>​                <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​            <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% lower precision for lower computation</span>
</span></span><span style="display:flex;"><span>​        A = round(A,<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% inverse A matrix for calculate approximation coefficient</span>
</span></span><span style="display:flex;"><span>​        S_tmp = pinv(A) <span style="color:#f92672">*</span> B_column;           
</span></span><span style="display:flex;"><span>​        S = [S S_tmp];
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>​    <span style="color:#75715e">% create approzimation B of each frequency region for later operation</span>
</span></span><span style="display:flex;"><span>​    B_approximation_set= [];
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : MaxSampleNum 
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% extract the Coefficient data of every region column by column</span>
</span></span><span style="display:flex;"><span>​        S_column = S(:,i);
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% create A matrix for second-order approximation </span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">for</span> n = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span> 
</span></span><span style="display:flex;"><span>​            <span style="color:#66d9ef">for</span> m = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>​                <span style="color:#66d9ef">for</span> k = <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>​                    A(m,k) = ( n_FreqTimeSample(i) )^( m<span style="color:#f92672">+</span>k<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span> );
</span></span><span style="display:flex;"><span>​                <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​            <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% approximate the frequency of each time samplefor each region </span>
</span></span><span style="display:flex;"><span>​        B_approximation_matrix = A<span style="color:#f92672">*</span>S_column;
</span></span><span style="display:flex;"><span>​        B_approximation_set = [ B_approximation_set B_approximation_matrix ];
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : MaxSampleNum
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% some sample point does not exist so its B_approximation will be 0</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% convert 0 to eps to avoid later operation problem (0/0=InF) </span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">if</span> ( B_approximation_set(<span style="color:#ae81ff">1</span>,i) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>​            B_approximation_set(<span style="color:#ae81ff">1</span>,i) = eps;
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% some frequency point does not exist so its Freq data will be 0</span>
</span></span><span style="display:flex;"><span>​        <span style="color:#75715e">% convert 0 to eps to avoid later operation problem (0/0=InF) </span>
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">if</span> ( FreqValueData(FrequencyRegion,i) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>​            FreqValueData(FrequencyRegion,i) = eps;
</span></span><span style="display:flex;"><span>​        <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​        
</span></span><span style="display:flex;"><span>​    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#75715e">% extract the data of approximation frequency we need in the first row</span>
</span></span><span style="display:flex;"><span>​    B_approximation = B_approximation_set(<span style="color:#ae81ff">1</span>,:);
</span></span><span style="display:flex;"><span>​    <span style="color:#75715e">% extract the data of real frequency we need row by row</span>
</span></span><span style="display:flex;"><span>​    FreqValueData_row = FreqValueData(FrequencyRegion,:);
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    <span style="color:#75715e">% calculate error data row by row for each region </span>
</span></span><span style="display:flex;"><span>​    error = sum(abs((B_approximation<span style="color:#f92672">-</span>FreqValueData_row) <span style="color:#f92672">./</span> FreqValueData_row)) <span style="color:#f92672">/</span> (MaxSampleNum);
</span></span><span style="display:flex;"><span>​    error_percentage = round( error<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">2</span> );
</span></span><span style="display:flex;"><span>​    
</span></span><span style="display:flex;"><span>​    error_set = [ error_set error_percentage ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% find total error for all frequency region </span>
</span></span><span style="display:flex;"><span>total_error = sum(error_set)<span style="color:#f92672">/</span>size(error_set,<span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>AllData = [ RealFreqValue ; EnergyRatioE2E1_set ; EnergyRatioE3E1_set; <span style="color:#75715e">...</span>
</span></span><span style="display:flex;"><span>            EnergyRatioOn_set ; EnergyRatioOff_set ; error_set ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HighFreqE2E1 = [];  
</span></span><span style="display:flex;"><span>HighFreqE3E1 = [];
</span></span><span style="display:flex;"><span>HighFreqOn = [];  
</span></span><span style="display:flex;"><span>HighFreqOff = [];  
</span></span><span style="display:flex;"><span>HighFreqError = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MiddleFreqE2E1 = [];
</span></span><span style="display:flex;"><span>MiddleFreqE3E1 = [];
</span></span><span style="display:flex;"><span>MiddleFreqOn = [];
</span></span><span style="display:flex;"><span>MiddleFreqOff = [];
</span></span><span style="display:flex;"><span>MiddleFreqError = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LowFreqE2E1 = [];  
</span></span><span style="display:flex;"><span>LowFreqE3E1 = [];
</span></span><span style="display:flex;"><span>LowFreqOn = [];  
</span></span><span style="display:flex;"><span>LowFreqOff = [];
</span></span><span style="display:flex;"><span>LowFreqError = [];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : label_max
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> AllData(<span style="color:#ae81ff">1</span>,i) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1000</span>       
</span></span><span style="display:flex;"><span>        HighFreqE2E1 = [ HighFreqE2E1  AllData(<span style="color:#ae81ff">2</span>,i) ];  
</span></span><span style="display:flex;"><span>        HighFreqE3E1 = [ HighFreqE3E1  AllData(<span style="color:#ae81ff">3</span>,i) ];  
</span></span><span style="display:flex;"><span>        HighFreqOn = [ HighFreqOn  AllData(<span style="color:#ae81ff">4</span>,i) ] ; 
</span></span><span style="display:flex;"><span>        HighFreqOff = [ HighFreqOff  AllData(<span style="color:#ae81ff">5</span>,i) ];  
</span></span><span style="display:flex;"><span>        HighFreqError = [ HighFreqError  AllData(<span style="color:#ae81ff">6</span>,i) ]; 
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elseif</span> AllData(<span style="color:#ae81ff">1</span>,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>        LowFreqE2E1 = [ LowFreqE2E1  AllData(<span style="color:#ae81ff">2</span>,i) ];  
</span></span><span style="display:flex;"><span>        LowFreqE3E1 = [ LowFreqE3E1  AllData(<span style="color:#ae81ff">3</span>,i) ];  
</span></span><span style="display:flex;"><span>        LowFreqOn = [ LowFreqOn  AllData(<span style="color:#ae81ff">4</span>,i) ] ; 
</span></span><span style="display:flex;"><span>        LowFreqOff = [ LowFreqOff  AllData(<span style="color:#ae81ff">5</span>,i) ];  
</span></span><span style="display:flex;"><span>        LowFreqError = [ LowFreqError  AllData(<span style="color:#ae81ff">6</span>,i) ]; 
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> 
</span></span><span style="display:flex;"><span>        MiddleFreqE2E1 = [ MiddleFreqE2E1  AllData(<span style="color:#ae81ff">2</span>,i) ];  
</span></span><span style="display:flex;"><span>        MiddleFreqE3E1 = [ MiddleFreqE3E1  AllData(<span style="color:#ae81ff">3</span>,i) ];  
</span></span><span style="display:flex;"><span>        MiddleFreqOn = [ MiddleFreqOn  AllData(<span style="color:#ae81ff">4</span>,i) ] ; 
</span></span><span style="display:flex;"><span>        MiddleFreqOff = [ MiddleFreqOff  AllData(<span style="color:#ae81ff">5</span>,i) ];  
</span></span><span style="display:flex;"><span>        MiddleFreqError = [ MiddleFreqError  AllData(<span style="color:#ae81ff">6</span>,i) ]; 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue1 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>HighFreqE2E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( HighFreqE2E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    HighFreqE2E1_sort = sort( HighFreqE2E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> HighFreqE2E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue1 = ( MeanValue1<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> HighFreqE2E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       HighFreqE2E1_sort(:,i) = MeanValue1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    HighFreqE2E1_sort_set = [ HighFreqE2E1_sort_set  HighFreqE2E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue2 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>HighFreqE3E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( HighFreqE3E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    HighFreqE3E1_sort = sort( HighFreqE3E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> HighFreqE3E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue2 = ( MeanValue2<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> HighFreqE3E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       HighFreqE3E1_sort(:,i) = MeanValue1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    HighFreqE3E1_sort_set = [ HighFreqE3E1_sort_set  HighFreqE3E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue3 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>HighFreqOn_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( HighFreqOn, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    HighFreqOn_sort = sort( HighFreqOn );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> HighFreqOn_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue3 = ( MeanValue3<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> HighFreqOn_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       HighFreqOn_sort(:,i) = MeanValue3;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    HighFreqOn_sort_set = [ HighFreqOn_sort_set  HighFreqOn_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue4 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>HighFreqOff_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( HighFreqOff, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    HighFreqOff_sort = sort( HighFreqOff );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> HighFreqOff_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue4 = ( MeanValue4<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> HighFreqOff_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       HighFreqOff_sort(:,i) = MeanValue4;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    HighFreqOff_sort_set = [ HighFreqOff_sort_set  HighFreqOff_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue5 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>HighFreqError_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( HighFreqError, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    HighFreqError_sort = sort( HighFreqError );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> HighFreqError_sort(i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span> 
</span></span><span style="display:flex;"><span>       MeanValue5 = ( MeanValue5<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> HighFreqError_sort(i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       HighFreqError_sort(i) = MeanValue5;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    HighFreqError_sort_set = [ HighFreqError_sort_set HighFreqError_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue6 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>MiddleFreqE2E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( MiddleFreqE2E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    MiddleFreqE2E1_sort = sort( MiddleFreqE2E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> MiddleFreqE2E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue6 = ( MeanValue6<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> MiddleFreqE2E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       MiddleFreqE2E1_sort(:,i) = MeanValue1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    MiddleFreqE2E1_sort_set = [ MiddleFreqE2E1_sort_set  MiddleFreqE2E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue7 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>MiddleFreqE3E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( MiddleFreqE3E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    MiddleFreqE3E1_sort = sort( MiddleFreqE3E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> MiddleFreqE3E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue7 = ( MeanValue7<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> MiddleFreqE3E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       MiddleFreqE3E1_sort(:,i) = MeanValue7;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    MiddleFreqE3E1_sort_set = [ MiddleFreqE3E1_sort_set  MiddleFreqE3E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue8 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>MiddleFreqOn_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( MiddleFreqOn, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    MiddleFreqOn_sort = sort( MiddleFreqOn );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> MiddleFreqOn_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue8 = ( MeanValue8<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> MiddleFreqOn_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       MiddleFreqOn_sort(:,i) = MeanValue8;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    MiddleFreqOn_sort_set = [ MiddleFreqOn_sort_set  MiddleFreqOn_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue9 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>MiddleFreqOff_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( MiddleFreqOff, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    MiddleFreqOff_sort = sort( MiddleFreqOff );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> MiddleFreqOff_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue9 = ( MeanValue9<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> MiddleFreqOff_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       MiddleFreqOff_sort(:,i) = MeanValue9;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    MiddleFreqOff_sort_set = [ MiddleFreqOff_sort_set  MiddleFreqOff_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue10 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>MiddleFreqError_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( MiddleFreqError, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    MiddleFreqError_sort = sort( MiddleFreqError );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> MiddleFreqError_sort(i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span> 
</span></span><span style="display:flex;"><span>       MeanValue10 = ( MeanValue10<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> MiddleFreqError_sort(i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       MiddleFreqError_sort(i) = MeanValue10;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    MiddleFreqError_sort_set = [ MiddleFreqError_sort_set  MiddleFreqError_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue11 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>LowFreqE2E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( LowFreqE2E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    LowFreqE2E1_sort = sort( LowFreqE2E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> LowFreqE2E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue11 = ( MeanValue11<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> LowFreqE2E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       LowFreqE2E1_sort(:,i) = MeanValue11;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    LowFreqE2E1_sort_set = [ LowFreqE2E1_sort_set LowFreqE2E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue12 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>LowFreqE3E1_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( LowFreqE3E1, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    LowFreqE3E1_sort = sort( LowFreqE3E1 );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> LowFreqE3E1_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue12 = ( MeanValue12<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> LowFreqE3E1_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       LowFreqE3E1_sort(:,i) = MeanValue12;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    LowFreqE3E1_sort_set = [ LowFreqE3E1_sort_set LowFreqE3E1_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue13 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>LowFreqOn_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( LowFreqOn, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    LowFreqOn_sort = sort( LowFreqOn );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> LowFreqOn_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue13 = ( MeanValue13<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> LowFreqOn_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       lowFreqOn_sort(:,i) = MeanValue13;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    LowFreqOn_sort_set = [ LowFreqOn_sort_set LowFreqOn_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue14 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>LowFreqOff_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( LowFreqOff, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    LowFreqOff_sort = sort( LowFreqOff );
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> LowFreqOff_sort(:,i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span> 
</span></span><span style="display:flex;"><span>       MeanValue14 = ( MeanValue14<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> LowFreqOff_sort(:,i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       LowFreqOff_sort(:,i) = MeanValue14;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    LowFreqOff_sort_set = [ LowFreqOff_sort_set  LowFreqOff_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MeanValue15 = <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>LowFreqError_sort_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size( LowFreqError, <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>    LowFreqError_sort = sort( LowFreqError );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> LowFreqError_sort(i) <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span> 
</span></span><span style="display:flex;"><span>       MeanValue15 = ( MeanValue15<span style="color:#f92672">*</span>(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> LowFreqError_sort(i) )<span style="color:#f92672">/</span>i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>       LowFreqError_sort(i) = MeanValue15;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    LowFreqError_sort_set = [ LowFreqError_sort_set  LowFreqError_sort(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HighFreqE2E1_mean = mean( HighFreqE2E1_sort_set )
</span></span><span style="display:flex;"><span>HighFreqE3E1_mean = mean( HighFreqE3E1_sort_set )
</span></span><span style="display:flex;"><span>HighFreqOn_mean = mean( HighFreqOn_sort_set )
</span></span><span style="display:flex;"><span>HighFreqOff_mean = mean( HighFreqOff_sort_set )
</span></span><span style="display:flex;"><span>HighFreqError_mean = mean( HighFreqError_sort_set )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MiddleFreqE2E1_mean = mean( MiddleFreqE2E1_sort_set )
</span></span><span style="display:flex;"><span>MiddleFreqE3E1_mean = mean( MiddleFreqE3E1_sort_set )
</span></span><span style="display:flex;"><span>MiddleFreqOn_mean = mean( MiddleFreqOn_sort_set )
</span></span><span style="display:flex;"><span>MiddleFreqOff_mean = mean( MiddleFreqOff_sort_set ) 
</span></span><span style="display:flex;"><span>MiddleFreqError_mean = mean( MiddleFreqError_sort_set )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LowFreqE2E1_mean = mean( LowFreqE2E1_sort_set )
</span></span><span style="display:flex;"><span>LowFreqE3E1_mean = mean( LowFreqE3E1_sort_set )
</span></span><span style="display:flex;"><span>LowFreqOn_mean = mean( LowFreqOn_sort_set )
</span></span><span style="display:flex;"><span>LowFreqOff_mean = mean( LowFreqOff_sort_set ) 
</span></span><span style="display:flex;"><span>LowFreqError_mean = mean( LowFreqError_sort_set )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SignalFeature = [ HighFreqE2E1_mean, HighFreqE3E1_mean, <span style="color:#75715e">... </span>
</span></span><span style="display:flex;"><span>                  HighFreqOn_mean, HighFreqOff_mean, HighFreqError_mean, <span style="color:#75715e">...</span>
</span></span><span style="display:flex;"><span>                  MiddleFreqE2E1_mean, MiddleFreqE3E1_mean, <span style="color:#75715e">... </span>
</span></span><span style="display:flex;"><span>                  MiddleFreqOn_mean, MiddleFreqOff_mean, MiddleFreqError_mean, <span style="color:#75715e">...</span>
</span></span><span style="display:flex;"><span>                  LowFreqE2E1_mean, LowFreqE3E1_mean, <span style="color:#75715e">... </span>
</span></span><span style="display:flex;"><span>                  LowFreqOn_mean, LowFreqOff_mean, LowFreqError_mean ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SignalFeature_kmeans = lbgVQ( SignalFeature, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_cello1.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d1_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_cello1,<span style="color:#ae81ff">3</span>)    
</span></span><span style="display:flex;"><span>    d1(i) = distanceEu( SignalFeature, library_cello1(:,:,i) );
</span></span><span style="display:flex;"><span>    d1_set = [ d1_set d1(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d1_data = sum( d1_set )<span style="color:#f92672">/</span>size(library_cello1,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_cello2.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d2_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_cello2,<span style="color:#ae81ff">3</span>)    
</span></span><span style="display:flex;"><span>    d2(i) = distanceEu( SignalFeature, library_cello2(:,:,i) );
</span></span><span style="display:flex;"><span>    d2_set = [ d2_set d2(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d2_data = sum( d2_set )<span style="color:#f92672">/</span>size(library_cello2,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_guitar1.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d3_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_guitar1,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d3(i) = distanceEu( SignalFeature, library_guitar1(:,:,i) );
</span></span><span style="display:flex;"><span>    d3_set = [ d3_set d3(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d3_data = sum( d3_set )<span style="color:#f92672">/</span>size(library_guitar1,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_guitar2.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d4_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_guitar2,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d4(i) = distanceEu( SignalFeature, library_guitar2(:,:,i) );
</span></span><span style="display:flex;"><span>    d4_set = [ d4_set d4(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d4_data = sum( d4_set )<span style="color:#f92672">/</span>size(library_guitar2,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_guitar3.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d5_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_guitar3,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d5(i) = distanceEu( SignalFeature, library_guitar3(:,:,i) );
</span></span><span style="display:flex;"><span>    d5_set = [ d5_set d5(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d5_data = sum( d5_set )<span style="color:#f92672">/</span>size(library_guitar3,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_piano1.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d6_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_piano1,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d6(i) = distanceEu( SignalFeature, library_piano1(:,:,i) );
</span></span><span style="display:flex;"><span>    d6_set = [ d6_set d6(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d6_data = sum( d6_set )<span style="color:#f92672">/</span>size(library_piano1,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_piano2.mat&#39;</span>)
</span></span><span style="display:flex;"><span>d7_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_piano2,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d7(i) = distanceEu( SignalFeature, library_piano2(:,:,i) );
</span></span><span style="display:flex;"><span>    d7_set = [ d7_set d7(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d7_data = sum( d7_set )<span style="color:#f92672">/</span>size(library_piano2,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>load(<span style="color:#e6db74">&#39;library_piano3.mat&#39;</span>) <span style="color:#75715e">% electro piano </span>
</span></span><span style="display:flex;"><span>d8_set = [];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i = <span style="color:#ae81ff">1</span> : size(library_piano3,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    d8(i) = distanceEu( SignalFeature, library_piano3(:,:,i) );
</span></span><span style="display:flex;"><span>    d8_set = [ d8_set d8(i) ];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>d8_data = sum( d8_set )<span style="color:#f92672">/</span>size(library_piano3,<span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">% Recoginition</span>
</span></span><span style="display:flex;"><span>RecogData = [ d1_data d2_data d3_data d4_data d5_data d6_data d7_data d8_data ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( min( RecogData ) <span style="color:#f92672">==</span> d1_data ) <span style="color:#f92672">||</span> ( min( RecogData ) <span style="color:#f92672">==</span> d2_data )
</span></span><span style="display:flex;"><span>    fprintf(<span style="color:#e6db74">&#39;The signal is Cello. &#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elseif</span> ( min( RecogData ) <span style="color:#f92672">==</span> d3_data ) <span style="color:#f92672">||</span> ( min( RecogData ) <span style="color:#f92672">==</span> d4_data ) <span style="color:#f92672">||</span> ( min( RecogData ) <span style="color:#f92672">==</span> d5_data )
</span></span><span style="display:flex;"><span>    fprintf(<span style="color:#e6db74">&#39;The signal is Guitar. &#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elseif</span> ( min( RecogData ) <span style="color:#f92672">==</span> d6_data ) <span style="color:#f92672">||</span> ( min( RecogData ) <span style="color:#f92672">==</span> d7_data ) <span style="color:#f92672">||</span> ( min( RecogData ) <span style="color:#f92672">==</span> d8_data )
</span></span><span style="display:flex;"><span>    fprintf(<span style="color:#e6db74">&#39;The signal is Piano. &#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div>
        </div>

        
        
      </div>
    </div>
  </div>
</section>



<footer class="text-capitalize">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 text-center mb-5">
        <a href="https://NTUneillee.github.io/"><img src="https://NTUneillee.github.io/images/logologo1.png" alt="Yuan-Kang Lee"></a>
      </div>
               
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Contact Me</h6>
        <ul class="list-unstyled">
          
                     
          <li class="mb-3"><i class="ti-location-pin mr-3 text-primary"></i>Taipei, Taiwan</li>
          
                     
          <li class="mb-3"><a class="text-dark" href="mailto:yuankang.neillee@gmail.com"><i
                class="ti-email mr-3 text-primary"></i>yuankang.neillee@gmail.com</a>
          
          </li>
        </ul>
      </div>
      
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Social Contacts</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://www.linkedin.com/in/yuankanglee">Linkedin</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://github.com/NTUneillee">Github</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://scholar.google.com/citations?user=CSHORSwAAAAJ&amp;hl=en">Google Scholar</a></li>
          
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Categories</h6>
        <ul class="list-unstyled">
          <li class="mb-3"><a class="text-dark"
              href="/categories/camera-image-quality/">Camera image quality</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/image-processing/">Image processing</a>
          </li>
          <li class="mb-3"><a class="text-dark"
              href="/categories/signal-processing/">Signal processing</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 col-sm-6 mb-5">
        <h6 class="mb-4">Quick Links</h6>
        <ul class="list-unstyled">
          
          <li class="mb-3"><a class="text-dark" href="https://NTUneillee.github.io/about/">About</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://NTUneillee.github.io/news/">News</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://NTUneillee.github.io/blog/">Project</a></li>
          
          <li class="mb-3"><a class="text-dark" href="https://NTUneillee.github.io/research/">Research</a></li>
          
        </ul>
      </div>
      <div class="col-12 border-top py-4 text-center">
        | © 2024 Yuan Kang Lee All Rights Reserved  |
      </div>
    </div>
  </div>
</footer>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script>
  var indexURL = "https://NTUneillee.github.io/index.json"
</script>

<!-- JS Plugins -->

<script src="https://NTUneillee.github.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://NTUneillee.github.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://NTUneillee.github.io/plugins/slick/slick.min.js"></script>

<script src="https://NTUneillee.github.io/plugins/venobox/venobox.min.js"></script>

<script src="https://NTUneillee.github.io/plugins/search/fuse.min.js"></script>

<script src="https://NTUneillee.github.io/plugins/search/mark.js"></script>

<script src="https://NTUneillee.github.io/plugins/search/search.js"></script>

<!-- Main Script -->

<script src="https://NTUneillee.github.io/js/script.min.js"></script>




<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	This site uses cookies. By continuing to use this website, you agree to their use. <span id="js-cookie-button" class="btn btn-sm btn-primary ml-2">I Accept</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires:  2 
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>


<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
</body>
</html>